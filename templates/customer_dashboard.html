{% extends 'base.html' %}{% extends 'base.html' %}

{% block title %}My Dashboard{% endblock %}{% block title %}Dashboard{% endblock %}

{% block content %}{% block content %}

<div class="container-fluid mt-3"><h3>Your Dashboard</h3>

  <h3 class="mb-4"><i class="bi bi-person-circle"></i> Welcome, {{ customer.name }}!</h3><div class="row">

    <div class="col-md-4">

  <!-- Financial Overview Cards -->    <div class="card p-3">

  <div class="row g-3 mb-4">      <h5>Products</h5>

    <div class="col-md-3">      <p>Total products: <strong>{{ total_products }}</strong></p>

      <div class="card border-primary shadow-sm">      <a class="btn btn-sm btn-primary" href="{{ url_for('products') }}">Browse products</a>

        <div class="card-body text-center">    </div>

          <i class="bi bi-cart-check fs-1 text-primary"></i>  </div>

          <h6 class="text-muted mt-2">Total Orders</h6>  <div class="col-md-4">

          <h2 class="text-primary">{{ my_orders }}</h2>    <div class="card p-3">

          <a href="{{ url_for('my_orders') }}" class="btn btn-sm btn-outline-primary">View Orders</a>      <h5>Orders</h5>

        </div>      <p>Your orders: <strong>{{ my_orders }}</strong></p>

      </div>      <a class="btn btn-sm btn-primary" href="{{ url_for('my_orders') }}">View my orders</a>

    </div>    </div>

    <div class="col-md-3">  </div>

      <div class="card border-info shadow-sm">  <div class="col-md-4">

        <div class="card-body text-center">    <div class="card p-3">

          <i class="bi bi-wallet2 fs-1 text-info"></i>      <h5>Payments</h5>

          <h6 class="text-muted mt-2">Total Spent</h6>      <p>Your payments: <strong>{{ my_payments }}</strong></p>

          <h3 class="text-info">₦{{ '{:,.2f}'.format(total_spent) }}</h3>      <a class="btn btn-sm btn-primary" href="{{ url_for('my_payments') }}">View payments</a>

          <small class="text-muted">All time</small>    </div>

        </div>  </div>

      </div></div>

    </div>

    <div class="col-md-3"><p class="mt-3">Quick actions:</p>

      <div class="card border-success shadow-sm"><div class="d-flex gap-2">

        <div class="card-body text-center">  <a class="btn btn-success" href="{{ url_for('add_order') }}">Place an order</a>

          <i class="bi bi-cash-coin fs-1 text-success"></i>  <a class="btn btn-outline-secondary" href="{{ url_for('products') }}">Browse products</a>

          <h6 class="text-muted mt-2">Total Paid</h6></div>

          <h3 class="text-success">₦{{ '{:,.2f}'.format(total_paid) }}</h3>{% endblock %}
          <a href="{{ url_for('my_payments') }}" class="btn btn-sm btn-outline-success">View Payments</a>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card border-warning shadow-sm">
        <div class="card-body text-center">
          <i class="bi bi-exclamation-triangle fs-1 text-warning"></i>
          <h6 class="text-muted mt-2">Outstanding</h6>
          <h3 class="{% if outstanding > 0 %}text-warning{% else %}text-success{% endif %}">
            ₦{{ '{:,.2f}'.format(outstanding) }}
          </h3>
          <small class="text-muted">Balance due</small>
        </div>
      </div>
    </div>
  </div>

  <!-- Quick Actions -->
  <div class="row g-3 mb-4">
    <div class="col-md-12">
      <div class="card shadow-sm">
        <div class="card-header bg-success text-white">
          <h5 class="mb-0"><i class="bi bi-lightning-fill"></i> Quick Actions</h5>
        </div>
        <div class="card-body">
          <div class="row g-2">
            <div class="col-md-3">
              <a class="btn btn-success w-100" href="{{ url_for('add_order') }}">
                <i class="bi bi-plus-circle"></i> Place New Order
              </a>
            </div>
            <div class="col-md-3">
              <a class="btn btn-outline-primary w-100" href="{{ url_for('products') }}">
                <i class="bi bi-box-seam"></i> Browse Products
              </a>
            </div>
            <div class="col-md-3">
              <a class="btn btn-outline-info w-100" href="{{ url_for('my_orders') }}">
                <i class="bi bi-list-check"></i> My Orders
              </a>
            </div>
            <div class="col-md-3">
              <a class="btn btn-outline-warning w-100" href="{{ url_for('my_payments') }}">
                <i class="bi bi-credit-card"></i> Payment History
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Recent Orders & Payments -->
  <div class="row g-3 mb-4">
    <div class="col-md-6">
      <div class="card shadow-sm">
        <div class="card-header bg-primary text-white">
          <h5 class="mb-0"><i class="bi bi-clock-history"></i> Recent Orders</h5>
        </div>
        <div class="card-body">
          {% if recent_orders %}
          <div class="table-responsive">
            <table class="table table-sm table-hover">
              <thead>
                <tr>
                  <th>Order #</th>
                  <th>Date</th>
                  <th>Total</th>
                  <th>Status</th>
                </tr>
              </thead>
              <tbody>
                {% for order in recent_orders %}
                <tr>
                  <td><strong>#{{ order.id }}</strong></td>
                  <td>{{ order.order_date[:10] }}</td>
                  <td>₦{{ '{:,.2f}'.format(order.total) }}</td>
                  <td>
                    <span class="badge bg-{{ 'success' if order.status == 'Completed' else 'warning' }}">
                      {{ order.status }}
                    </span>
                  </td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
          <a href="{{ url_for('my_orders') }}" class="btn btn-sm btn-outline-primary w-100 mt-2">View All Orders</a>
          {% else %}
          <div class="alert alert-info">
            <i class="bi bi-info-circle"></i> You haven't placed any orders yet.
            <a href="{{ url_for('add_order') }}" class="alert-link">Place your first order now!</a>
          </div>
          {% endif %}
        </div>
      </div>
    </div>

    <div class="col-md-6">
      <div class="card shadow-sm">
        <div class="card-header bg-success text-white">
          <h5 class="mb-0"><i class="bi bi-credit-card-2-front"></i> Recent Payments</h5>
        </div>
        <div class="card-body">
          {% if recent_payments %}
          <div class="table-responsive">
            <table class="table table-sm table-hover">
              <thead>
                <tr>
                  <th>Order #</th>
                  <th>Date</th>
                  <th>Amount</th>
                  <th>Status</th>
                </tr>
              </thead>
              <tbody>
                {% for payment in recent_payments %}
                <tr>
                  <td><strong>#{{ payment.order_id }}</strong></td>
                  <td>{{ payment.date_paid[:10] }}</td>
                  <td>₦{{ '{:,.2f}'.format(payment.amount) }}</td>
                  <td>
                    <span class="badge bg-{{ 'success' if payment.status == 'Paid' else 'warning' }}">
                      {{ payment.status }}
                    </span>
                  </td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
          <a href="{{ url_for('my_payments') }}" class="btn btn-sm btn-outline-success w-100 mt-2">View All Payments</a>
          {% else %}
          <div class="alert alert-info">
            <i class="bi bi-info-circle"></i> No payment records yet.
          </div>
          {% endif %}
        </div>
      </div>
    </div>
  </div>

  <!-- Account Information -->
  <div class="row g-3 mb-4">
    <div class="col-md-12">
      <div class="card shadow-sm">
        <div class="card-header bg-dark text-white">
          <h5 class="mb-0"><i class="bi bi-person-badge"></i> Account Information</h5>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-md-6">
              <p><strong>Name:</strong> {{ customer.name }}</p>
              <p><strong>Email:</strong> {{ customer.email }}</p>
            </div>
            <div class="col-md-6">
              <p><strong>Phone:</strong> {{ customer.phone or 'Not provided' }}</p>
              <p><strong>Address:</strong> {{ customer.address or 'Not provided' }}</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
